# 3.8: CRC32 Code Validation

The STM32F030 family comes with a CRC calculation unit. It can be used
during startup to validate the integrity of the code in memory.

Cyclic Redundancy Check is a way to do error detection and correction. I
have already met CRC when dealing with the DS18B20 sensor where CRC8 is used
during the scratchpad 9 bytes transmission.

The STM32 CRC calculation unit has the following default characteristic:

- POLY32 is 0x04C11DB7

- Initialisation 0xFFFFFFFF

- High bit first (left shift)

- 32 bit word input, little endian

I don't plan to write a self-signing software, so on top of the STM32
startup code validation, I will also write a sign32 command to sign
binary files during build.

## Implementation Steps

- Update **stm32f030xx.h** with the CRC calculation unit definitions.

- Update startup with `check_flash()` to be tested before `init()` is
  called.

- Update **generic.ld** with a new section used as placeholder for the CRC
  sum at the end of the flashable content.

- Write `sign32` command to sign a binary file.

- Update **Makefile** to sign the binary executable and create an intel hex
  version out of it.

## Checkpoint

[Next]( 39_resistor) I will use the ADC to read a resistor value.

___
Â© 2020-2021 Renaud Fivet
